# 移动端适配说明

## 已实现功能

### 1. 触控支持
- 添加了 `TouchInputManager` 类来管理触摸输入
- 自动检测移动设备并启用触控支持
- 支持多点触控（最多3个触点）

### 2. 虚拟控制按钮
- **方向控制**：左右移动按钮
- **跳跃按钮**：支持单跳和双跳
- **射击按钮**：触摸即可发射子弹
- 按钮带有视觉反馈（按下时透明度变化）

### 3. 响应式布局
- 使用 Phaser.Scale.FIT 模式自动适配不同屏幕尺寸
- 设置了最小和最大分辨率限制
- 画布自动居中显示

### 4. 移动端性能优化
- 自动检测设备类型并调整渲染参数
- 移动端限制帧率为30fps以节省电量
- 降低移动端的批处理大小和纹理数量
- 禁用移动端抗锯齿以提高性能
- 根据设备DPR自动调整分辨率

### 5. 用户体验优化
- 防止默认的触摸行为（如双击缩放、滚动等）
- 添加横屏提示（建议横屏游玩）
- 支持全屏模式（首次触摸时自动请求）
- 防止屏幕休眠（Wake Lock API）
- 禁用右键菜单

### 6. 手势支持
- 上滑手势触发跳跃
- 触摸区域自动映射到对应控制

## 使用说明

### 移动端控制
- **移动**：点击左右箭头按钮
- **跳跃**：点击 JUMP 按钮或向上滑动
- **射击**：点击 SHOOT 按钮
- **重启游戏**：刷新页面

### 浏览器兼容性
支持以下移动浏览器：
- iOS Safari
- Chrome for Android
- Firefox for Android
- 微信内置浏览器
- 其他基于 WebKit 的浏览器

## 技术实现细节

### 文件结构
- `src/game/managers/TouchInputManager.ts` - 触控输入管理器
- `src/game/utils/MobileOptimization.ts` - 移动端优化工具类
- `src/game/ui/OrientationOverlay.ts` - 横屏提示组件
- `src/game/sprites/Player.ts` - 更新了玩家控制以支持触控

### 配置更改
- `src/game/main.ts` - 添加了移动端特定配置
- `index.html` - 添加了移动端元标签
- `public/style.css` - 添加了触摸相关CSS

## 测试方法

### 在电脑上测试
1. 打开 Chrome 开发者工具
2. 切换到设备模拟模式 (Ctrl+Shift+M)
3. 选择一个移动设备预设
4. 刷新页面

### 在真实设备上测试
1. 确保手机和电脑在同一网络
2. 运行 `npm run dev -- --host`
3. 在手机浏览器访问显示的网络地址

## 注意事项

1. 虚拟按钮只在移动设备上显示
2. 游戏建议在横屏模式下游玩
3. 首次触摸会自动请求全屏（部分浏览器可能不支持）
4. 性能优化会自动根据设备类型调整